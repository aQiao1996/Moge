# å¼€å‘æŒ‡å—

æœ¬æ–‡ä»¶å®šä¹‰äº†åº”ç”¨çš„æ ¸å¿ƒæ¶æ„å†³ç­–ã€å¼€å‘è§„èŒƒä¸å®æ–½ç­–ç•¥ã€‚

---

## 1. å…¨å±€æ ¸å¿ƒç³»ç»Ÿ

### 1.1. `@` æ™ºèƒ½å¼•ç”¨ç³»ç»Ÿ

è¿™æ˜¯æ‰“é€šæ‰€æœ‰æ¨¡å—ã€æå‡äº§å“ä»·å€¼çš„æ ¸å¿ƒç³»ç»Ÿã€‚

- **ç›®æ ‡**: å®ç° `è®¾å®šé›†`ã€`å¤§çº²`ã€`æ­£æ–‡` ä¹‹é—´çš„æ— ç¼é“¾æ¥ã€‚
- **æ ¸å¿ƒæµç¨‹**:
  1.  **è§¦å‘ä¸æ’å…¥**: åœ¨ä»»ä½•ç¼–è¾‘å™¨ä¸­è¾“å…¥ `@`ï¼Œè§¦å‘å…¨å±€è®¾å®šæœç´¢ï¼Œé€‰æ‹©åæ’å…¥ä¸€ä¸ªåŒ…å«å”¯ä¸€IDçš„ç¨³å®šé“¾æ¥ï¼ˆå¦‚ `[@é£é›ªåŸ](moge://item/uuid-xxx)`ï¼‰ã€‚
  2.  **æ‚¬æµ®ä¸è·³è½¬**: åœ¨é˜…è¯»æ—¶ï¼Œé¼ æ ‡æ‚¬æµ®äº `@é“¾æ¥` ä¸Šå¯é¢„è§ˆè®¾å®šç®€ä»‹å¡ç‰‡ï¼›ç‚¹å‡»åˆ™ç›´æ¥è·³è½¬è‡³è¯¥è®¾å®šçš„è¯¦æƒ…é¡µã€‚
  3.  **åå‘é“¾æ¥**: åœ¨è®¾å®šçš„è¯¦æƒ…é¡µï¼Œèƒ½è‡ªåŠ¨å±•ç¤ºæ‰€æœ‰å¼•ç”¨äº†è¯¥è®¾å®šçš„â€œå‡ºåœºç« èŠ‚â€åˆ—è¡¨ã€‚
- **æŠ€æœ¯è¦ç‚¹**: éœ€è¦åç«¯æä¾›ç»Ÿä¸€æœç´¢æ¥å£ã€å‰ç«¯å®ç°ç¼–è¾‘å™¨æ’ä»¶å’Œ Markdown è‡ªå®šä¹‰æ¸²æŸ“ç»„ä»¶ã€‚

### 1.2. å­—å…¸ç®¡ç†ä¸è®¾å®šé›†çš„ååŒè®¾è®¡

**æ•°æ®å±‚çº§å…³ç³»**:

- **å­—å…¸ç®¡ç†**: ç»´æŠ¤å…¨å±€æ ‡å‡†åŒ–æ•°æ®ï¼ˆå°è¯´ç±»å‹ã€é€šç”¨æ ‡ç­¾ã€æ¨¡æ¿ç­‰ï¼‰
- **è®¾å®šé›†**: ä½¿ç”¨å­—å…¸æ•°æ®ï¼Œå¹¶å¯æ‰©å±•é¡¹ç›®ä¸“å±å†…å®¹
- **ååŒæœºåˆ¶**: è®¾å®šé›†ä¸­çš„æ ‡ç­¾é€‰æ‹©å™¨ä»å­—å…¸ç®¡ç†è·å–é€‰é¡¹ï¼Œæ”¯æŒå¿«é€Ÿæ·»åŠ è‡ªå®šä¹‰æ ‡ç­¾

**å…¸å‹ä½¿ç”¨æµç¨‹**:

1. åœ¨å­—å…¸ç®¡ç†ä¸­ç»´æŠ¤å°è¯´ç±»å‹å’Œæ ‡ç­¾åº“
2. åˆ›å»ºé¡¹ç›®æ—¶ä»å­—å…¸ä¸­é€‰æ‹©ç±»å‹å’ŒåŸºç¡€æ ‡ç­¾
3. åœ¨è®¾å®šé›†ä¸­åˆ›å»ºè§’è‰²/ç³»ç»Ÿ/ä¸–ç•Œæ—¶ï¼Œæ ‡ç­¾é€‰æ‹©å™¨è‡ªåŠ¨åŠ è½½ç›¸å…³è¯æ±‡
4. æ”¯æŒåœ¨è®¾å®šåˆ›å»ºè¿‡ç¨‹ä¸­ä¸´æ—¶æ·»åŠ æ–°è¯æ±‡ï¼Œå¯é€‰æ‹©æ˜¯å¦åŠ å…¥ä¸ªäººå­—å…¸

### 1.3. AI å¼€å‘è§„èŒƒ

**æ ¸å¿ƒåŸåˆ™**: AI åŠŸèƒ½çš„æ ¸å¿ƒç›®æ ‡æ˜¯è¾…åŠ©ç”¨æˆ·åˆ›ä½œï¼Œæå‡å†…å®¹ç”Ÿäº§æ•ˆç‡å’Œä¸€è‡´æ€§ï¼Œè€Œä¸æ˜¯å–ä»£ç”¨æˆ·ã€‚

**è§„åˆ’åŠŸèƒ½ä¸è§„èŒƒ**:

- **è®¾å®šä¸Šä¸‹æ–‡æ³¨å…¥**:
  - **è§„èŒƒ**: åœ¨è°ƒç”¨ AI ç”Ÿæˆå†…å®¹ï¼ˆå¦‚å¤§çº²ã€ç« èŠ‚ï¼‰æ—¶ï¼Œå¿…é¡»è‡ªåŠ¨è·å–å½“å‰é¡¹ç›®å…³è”çš„æ‰€æœ‰è®¾å®šé›†ï¼ˆè§’è‰²ã€ä¸–ç•Œè§‚ã€ç³»ç»Ÿç­‰ï¼‰ä½œä¸ºä¸Šä¸‹æ–‡ä¿¡æ¯ï¼Œæä¾›ç»™ AI æ¨¡å‹ã€‚
  - **ç›®æ ‡**: ç¡®ä¿ AI ç”Ÿæˆçš„å†…å®¹ç¬¦åˆç”¨æˆ·å·²ç»åˆ›å»ºçš„ç‹¬ç‰¹ä¸–ç•Œè§‚ï¼Œä¿è¯æ•…äº‹çš„ä¸€è‡´æ€§ã€‚
- **AI ç”Ÿæˆå¢å¼º**:
  - **æ”¯æŒè®¾å®šæ‘˜è¦æ³¨å…¥**ï¼Œæå‡ AI ç”Ÿæˆå†…å®¹çš„ä¸€è‡´æ€§ã€‚
  - **æ™ºèƒ½è¯†åˆ«ç›¸å…³è®¾å®š**ï¼Œä¼˜å…ˆä½¿ç”¨é«˜ç›¸å…³åº¦çš„è®¾å®šä¿¡æ¯ã€‚
  - **ç”Ÿæˆç»“æœè‡ªåŠ¨è§£æ**å¹¶å»ºç«‹ @ å¼•ç”¨å…³ç³»ã€‚

---

## 2. æ ¸å¿ƒå¼€å‘è§„åˆ™

### 2.1. ä»£ç è´¨é‡ä¸ç»´æŠ¤æ€§

- **ä¸­æ–‡æ³¨é‡Šè§„èŒƒ**: ä¸ºæ‰€æœ‰æ ¸å¿ƒå‡½æ•°ã€å¤æ‚é€»è¾‘æ·»åŠ å®Œæ•´çš„ä¸­æ–‡JSDocæ³¨é‡Šï¼ŒåŒ…å«åŠŸèƒ½æè¿°ã€å‚æ•°è¯´æ˜ã€è¿”å›å€¼è¯´æ˜ã€‚
- **ç±»å‹å®‰å…¨**: å¿…é¡»ä¿è¯å®Œæ•´çš„TypeScriptç±»å‹å®šä¹‰å’ŒéªŒè¯ï¼Œé€šè¿‡æ‰€æœ‰ä¸¥æ ¼ç±»å‹æ£€æŸ¥ã€‚
- **é”™è¯¯å¤„ç†**: å»ºç«‹ç»Ÿä¸€çš„é”™è¯¯å¤„ç†æœºåˆ¶ï¼Œé¿å…åœ¨ä¸šåŠ¡ä»£ç ä¸­å‡ºç°é›¶æ•£çš„ã€é‡å¤çš„é”™è¯¯æç¤ºï¼ˆå¦‚ toastï¼‰ã€‚
- **ç»„ä»¶å¤ç”¨**: ä¼˜å…ˆä½¿ç”¨é¡¹ç›®ä¸­å·²æœ‰çš„UIç»„ä»¶ï¼ˆå¦‚ `MogeFormDialog`ï¼‰å’Œä¸šåŠ¡ç»„ä»¶ï¼Œä¿è¯UIå’Œäº¤äº’çš„ä¸€è‡´æ€§ã€‚
- **æ€§èƒ½ä¼˜åŒ–**: éµå¾ªReactæœ€ä½³å®è·µï¼ˆå¦‚ `useCallback`, `useMemo`, å‡½æ•°å¼ `setState`ï¼‰ï¼Œé¿å…ä¸å¿…è¦çš„é‡æ¸²æŸ“å’Œæ— é™å¾ªç¯ã€‚

### 2.2. API æ¶æ„è§„èŒƒ

- **ç»Ÿä¸€å…¥å£**: å»ºç«‹ç»Ÿä¸€çš„æ•°æ®è·å–å…¥å£ï¼ˆå¦‚ `settings.api.ts`ï¼‰ï¼Œæ”¯æŒå¹¶è¡Œå’Œå•ç‹¬è¯·æ±‚ã€‚
- **åç«¯è§„èŒƒ**:
  - **æŠ€æœ¯æ ˆ**: ä½¿ç”¨ NestJS Controller/Service æ¶æ„ã€‚
  - **è®¤è¯**: æ‰€æœ‰éœ€æˆæƒæ¥å£åŸºäº JWT è®¤è¯ï¼Œè‡ªåŠ¨ä» token è·å–ç”¨æˆ·ä¿¡æ¯ã€‚
  - **ORM**: ä½¿ç”¨ Prisma ORMï¼Œå¹¶ä½¿ç”¨å…¶ç”Ÿæˆçš„ç±»å‹ç³»ç»Ÿï¼ˆå¦‚ `Prisma.character_settingsCreateInput`ï¼‰ã€‚
  - **æƒé™**: ç¡®ä¿ç”¨æˆ·åªèƒ½æ“ä½œè‡ªå·±çš„æ•°æ®ã€‚
  - **æ–‡æ¡£**: éœ€æä¾›å®Œæ•´çš„ Swagger API æ–‡æ¡£å’Œç±»å‹å®šä¹‰ã€‚
- **å­—æ®µæ˜ å°„**: ä¿è¯å‰åç«¯å­—æ®µå®Œå…¨å¯¹é½ï¼Œç»Ÿä¸€ä½¿ç”¨æ•°æ®åº“ schema ä¸­å®šä¹‰çš„å­—æ®µåï¼ˆå¦‚ `remarks`ï¼‰ã€‚

### 2.3. è¡¨å•ä¸å¼¹æ¡†å¼€å‘

- **è¡¨å•éªŒè¯**: ä½¿ç”¨ Zod è¿›è¡Œå®Œæ•´çš„æ•°æ®éªŒè¯ã€‚
- **ç»„ä»¶å‡çº§**: å¯¹åŸºç¡€ç»„ä»¶ï¼ˆå¦‚ `MogeFormDialog`ï¼‰çš„å‡çº§æ”¹é€ ï¼Œéœ€è¦æ”¯æŒæ›´çµæ´»çš„é…ç½®ï¼ˆå¦‚ `section` åˆ†ç»„ï¼‰ï¼Œå¹¶ä¿æŒå‘ä¸‹å…¼å®¹ã€‚
- **å¤šé€‰ç»„ä»¶ (`MogeMultiSelect`)**:
  - **åŠŸèƒ½**: å¿…é¡»æ”¯æŒæœç´¢è¿‡æ»¤ã€æ ‡ç­¾å±•ç¤ºã€æ‰¹é‡é€‰æ‹©/æ¸…é™¤ç­‰åŠŸèƒ½ã€‚
  - **ä½“éªŒ**: éœ€å¤„ç†å¥½åŠ è½½çŠ¶æ€ã€ç©ºçŠ¶æ€å’Œé”™è¯¯çŠ¶æ€ï¼Œå¹¶åšå¥½å“åº”å¼è®¾è®¡ã€‚

---

## 3. æ¶æ„è®¾è®¡ä¸æ–¹æ¡ˆå¯¹æ¯”

### 3.1. `è®¾å®šé›†` æ¨¡å—æ¶æ„

- **åŒé‡æ¶æ„**: é‡‡ç”¨â€œé¡¹ç›®å…³è”è®¾å®š + ç‹¬ç«‹è®¾å®šåº“â€çš„åŒé‡æ¶æ„ï¼Œå…¼é¡¾é¡¹ç›®å†…ç®¡ç†å’Œè·¨é¡¹ç›®å¤ç”¨ã€‚
- **ç•Œé¢æ¶æ„**:
  - **é¦–é¡µ (`/settings`)**: å°è¯´é¡¹ç›®åˆ—è¡¨ï¼Œä½œä¸ºè®¾å®šé›†çš„å…¥å£ã€‚
  - **åˆ†ç±»é¡µ (`/settings/[projectId]`)**: å±•ç¤ºå•ä¸ªé¡¹ç›®ä¸‹çš„å››å¤§è®¾å®šåˆ†ç±»ï¼ˆè§’è‰²ã€ç³»ç»Ÿã€ä¸–ç•Œã€è¾…åŠ©ï¼‰ã€‚
  - **ç‹¬ç«‹è®¾å®šåº“ (`/settings/library`)**: è·¨é¡¹ç›®çš„ç‹¬ç«‹è®¾å®šç®¡ç†ç³»ç»Ÿï¼ŒåŒæ ·æŒ‰å››å¤§åˆ†ç±»ç»„ç»‡ã€‚
- **è§†å›¾æ¨¡å¼**: åˆ—è¡¨éœ€æ”¯æŒå¡ç‰‡è§†å›¾å’Œè¡¨æ ¼ï¼ˆæˆ–åˆ—è¡¨ï¼‰è§†å›¾ä¸¤ç§æ¨¡å¼ï¼Œå¹¶æä¾›æœç´¢ã€ç­›é€‰ã€æ’åºç­‰åŸºç¡€åŠŸèƒ½ã€‚
- **å­è·¯ç”±ç»“æ„**: é‡‡ç”¨ `settings/characters/[id]` è¿™æ ·çš„æ¸…æ™°å±‚çº§ï¼Œåˆ†ç¦»"ä¸»é¡µ"ã€"åˆ—è¡¨é¡µ"å’Œ"è¯¦æƒ…é¡µ"ã€‚

### 3.2. `ä¸–ç•Œè®¾å®š` åŠŸèƒ½è®¾è®¡æ–¹æ¡ˆå¯¹æ¯”

åœ¨è®¾è®¡ `ä¸–ç•Œè®¾å®š` çš„æ•°æ®ç»“æ„æ—¶ï¼Œå¯¹å¤šç§æ–¹æ¡ˆè¿›è¡Œäº†å¯¹æ¯”ï¼š

- **æ–¹æ¡ˆä¸€ï¼šåˆ†å±‚çº§ç»“æ„æ–¹æ¡ˆ**
  - **ç»“æ„**: ä¸–ç•Œæ€»è§ˆ â†’ å¤§é™†/æ˜Ÿçƒ â†’ å›½å®¶/ç‹å›½ â†’ åœ°åŒº/çœä»½ â†’ åŸå¸‚/æ®ç‚¹
  - **ä¼˜ç‚¹**: å±‚æ¬¡æ¸…æ™°ï¼Œé€‚åˆå¤§å‹å¤æ‚ä¸–ç•Œè§‚ã€‚
  - **ç¼ºç‚¹**: å¯¹ç®€å•ä¸–ç•Œè§‚è¿‡äºå¤æ‚ï¼Œæ“ä½œç¹çã€‚
  - **ç»“è®º**: æœªé‡‡ç”¨ã€‚

- **æ–¹æ¡ˆäºŒï¼šåˆ†ç±»æ¨¡å—æ–¹æ¡ˆ** â­ **å·²é‡‡ç”¨**
  - **ç»“æ„**: åŸºç¡€ä¿¡æ¯ | åœ°ç†ç¯å¢ƒ | æ”¿æ²»åŠ¿åŠ› | æ–‡åŒ–ä½“ç³» | ä¿®ç‚¼/åŠ›é‡ä½“ç³» | å†å²è„‰ç»œ
  - **ä¼˜ç‚¹**: æ¨¡å—åŒ–æ˜“äºç†è§£ï¼Œé€šç”¨æ€§å¼ºï¼Œå¯é€‰æ‹©æ€§å¡«å†™ï¼Œæ‰©å±•æ€§å¥½ã€‚
  - **ç¼ºç‚¹**: ä¿¡æ¯å¯èƒ½åœ¨ä¸åŒæ¨¡å—é—´æœ‰é‡å¤ã€‚
  - **ç»“è®º**: ä½œä¸ºä¸»ä½“æ¶æ„ï¼Œé€šç”¨æ€§æœ€å¼ºã€‚

- **æ–¹æ¡ˆä¸‰ï¼šæ—¶é—´çº¿å¯¼å‘æ–¹æ¡ˆ**
  - **ç»“æ„**: ä»¥æ—¶é—´çº¿ï¼ˆè¿œå¤ã€å¤ä»£ã€å½“å‰ï¼‰ä¸ºä¸»è½´ï¼Œå…³è”ç©ºé—´è®¾å®šã€‚
  - **ä¼˜ç‚¹**: å†å²è„‰ç»œæ¸…æ™°ï¼Œé€‚åˆå†å²åšé‡çš„è®¾å®šã€‚
  - **ç¼ºç‚¹**: å¯¹ç°ä»£/æœªæ¥é¢˜æä¸å¤Ÿç›´è§‚ã€‚
  - **ç»“è®º**: æœªé‡‡ç”¨ã€‚

- **æ–¹æ¡ˆå››ï¼šåŠ¿åŠ›ä¸­å¿ƒæ–¹æ¡ˆ**
  - **ç»“æ„**: ä»¥ä¸»è¦åŠ¿åŠ›ä¸ºæ ¸å¿ƒï¼Œå±•å¼€æè¿°ä¸­ç«‹åŒºåŸŸå’Œè·¨åŠ¿åŠ›è®¾å®šã€‚
  - **ä¼˜ç‚¹**: é€‚åˆåŠ¿åŠ›æ–—äº‰ä¸»çº¿ï¼Œç¬¦åˆç½‘æ–‡å¸¸è§æ¨¡å¼ã€‚
  - **ç¼ºç‚¹**: å¯èƒ½å¿½ç•¥è‡ªç„¶ç¯å¢ƒï¼Œå¯¹ä¸ªäººå†’é™©ç±»æ•…äº‹ä¸é€‚ç”¨ã€‚
  - **ç»“è®º**: æœªé‡‡ç”¨ã€‚

### 3.3. `æ–‡ç¨¿` æ¨¡å—æ¶æ„è®¾è®¡

**æ ¸å¿ƒå®šä½**: æ–‡ç¨¿æ¨¡å—æ˜¯ä½œè€…è¿›è¡Œæ­£æ–‡åˆ›ä½œçš„æ ¸å¿ƒå·¥ä½œåŒº,å°†å¤§çº²è½¬åŒ–ä¸ºå®Œæ•´å°è¯´å†…å®¹çš„åœ°æ–¹ã€‚

**ä¸»è¦åŠŸèƒ½èŒè´£**:

1. **æ–‡ç¨¿é¡¹ç›®ç®¡ç†**
   - æ–‡ç¨¿åˆ—è¡¨å±•ç¤º(å¡ç‰‡/åˆ—è¡¨è§†å›¾)
   - æ–‡ç¨¿ CRUD(åˆ›å»ºã€ç¼–è¾‘ã€åˆ é™¤)
   - çŠ¶æ€ç®¡ç†(æ„æ€ä¸­/è¿›è¡Œä¸­/å·²å®Œç»“/å·²å‘å¸ƒ)
   - ç­›é€‰æ’åº(æŒ‰åç§°ã€çŠ¶æ€ã€æ›´æ–°æ—¶é—´ã€å­—æ•°ç­‰)
   - å…³è”å¤§çº²å’Œè®¾å®šé›†é¡¹ç›®

2. **ç« èŠ‚ç»“æ„ç®¡ç†**
   - å·ç« æ ‘å½¢ç»“æ„å±•ç¤º
   - åˆ›å»º/åˆ é™¤/é‡å‘½åå·å’Œç« èŠ‚
   - æ‹–æ‹½æ’åº
   - æ”¯æŒç‰¹æ®Šç« èŠ‚ç±»å‹(åºç« /æ¥”å­ã€æ­£æ–‡ç« èŠ‚ã€ç•ªå¤–/åè®°)

3. **æ­£æ–‡ç¼–è¾‘ä¸å†™ä½œ** (æ ¸å¿ƒ)
   - Markdown ç¼–è¾‘å™¨(å®æ—¶é¢„è§ˆã€å¿«æ·é”®ã€è‡ªåŠ¨ä¿å­˜)
   - å­—æ•°ç»Ÿè®¡(å®æ—¶æ˜¾ç¤ºå½“å‰ç« èŠ‚/å½“å¤©/æ€»å­—æ•°)
   - ç‰ˆæœ¬å†å²(æ”¯æŒå†…å®¹ç‰ˆæœ¬ç®¡ç†å’Œå›æ»š)
   - ä¸“æ³¨æ¨¡å¼(å…¨å±å†™ä½œ,éšè—å¹²æ‰°å…ƒç´ )
   - è‡ªåŠ¨ä¿å­˜(æ¯ 30 ç§’æˆ–å†…å®¹å˜æ›´æ—¶)

4. **AI è¾…åŠ©åˆ›ä½œ**
   - AI ç»­å†™(æ ¹æ®ä¸Šæ–‡å’Œè®¾å®šç»­å†™åç»­å†…å®¹)
   - AI æ¶¦è‰²(ä¼˜åŒ–æ–‡å­—è¡¨è¾¾ã€ä¿®æ­£è¯­æ³•é”™è¯¯)
   - AI æ‰©å†™(å°†ç®€çŸ­å¤§çº²æ‰©å†™ä¸ºå®Œæ•´ç« èŠ‚)
   - AI æ”¹å†™(æ ¹æ®æŒ‡ä»¤è°ƒæ•´æ–‡é£ã€è§†è§’ç­‰)
   - ä¸Šä¸‹æ–‡æ³¨å…¥(è‡ªåŠ¨æ³¨å…¥å…³è”çš„è®¾å®šã€å‰å‡ ç« å‰§æƒ…æ‘˜è¦ã€å¤§çº²è¦ç‚¹)

5. **è®¾å®šå…³è”ä¸å¼•ç”¨** (ä¸ @ ç³»ç»Ÿé›†æˆ)
   - åœ¨ç¼–è¾‘å™¨ä¸­è¾“å…¥ `@` è§¦å‘è®¾å®šæœç´¢
   - æ’å…¥è®¾å®šå¼•ç”¨(å¦‚ `[@æå°å‡¡](moge://character/123)`)
   - æ‚¬æµ®é¢„è§ˆè®¾å®šè¯¦æƒ…
   - ç‚¹å‡»è·³è½¬åˆ°è®¾å®šé¡µé¢
   - åå‘é“¾æ¥(åœ¨è®¾å®šè¯¦æƒ…é¡µæ˜¾ç¤º"è¯¥è§’è‰²åœ¨å“ªäº›ç« èŠ‚å‡ºåœº")

6. **å‘å¸ƒä¸å¯¼å‡º**
   - ç« èŠ‚å‘å¸ƒ(æ ‡è®°ç« èŠ‚ä¸º"å·²å‘å¸ƒ"çŠ¶æ€)
   - å®šæ—¶å‘å¸ƒ
   - å¯¼å‡ºåŠŸèƒ½(TXT/EPUB/DOCX,æ”¯æŒé€‰æ‹©å¯¼å‡ºèŒƒå›´)
   - å‘å¸ƒè®°å½•(è®°å½•æ¯æ¬¡å‘å¸ƒçš„æ—¶é—´ã€å­—æ•°ã€ç« èŠ‚)

7. **ç»Ÿè®¡ä¸åˆ†æ**
   - å­—æ•°ç»Ÿè®¡(ä»Šæ—¥å­—æ•°ã€æœ¬å‘¨å­—æ•°ã€æ€»å­—æ•°ã€å­—æ•°è¶‹åŠ¿å›¾)
   - å†™ä½œä¹ æƒ¯åˆ†æ(å†™ä½œæ´»è·ƒæ—¶é—´åˆ†å¸ƒã€å¹³å‡æ¯æ—¥å­—æ•°ã€æ›´æ–°é¢‘ç‡)
   - è¿›åº¦è·Ÿè¸ª(ç›®æ ‡å­—æ•°è®¾å®šã€å®Œæˆè¿›åº¦ç™¾åˆ†æ¯”ã€é¢„è®¡å®Œç»“æ—¶é—´)

**æ•°æ®åº“è®¾è®¡**:

- `manuscripts` è¡¨: æ–‡ç¨¿å…ƒæ•°æ®(åç§°ã€æè¿°ã€çŠ¶æ€ã€å…³è”å¤§çº² IDã€å…³è”é¡¹ç›® IDã€æ€»å­—æ•°ç­‰)
- `manuscript_volumes` è¡¨: å·ä¿¡æ¯(å‚è€ƒ outline_volume è®¾è®¡)
- `manuscript_chapters` è¡¨: ç« èŠ‚å…ƒæ•°æ®(å‚è€ƒ outline_chapter è®¾è®¡)
- `manuscript_chapter_content` è¡¨: ç« èŠ‚å†…å®¹(content å­—æ®µã€ç‰ˆæœ¬å·)
- `manuscript_chapter_content_version` è¡¨: ç« èŠ‚å†…å®¹ç‰ˆæœ¬å†å²

**é¡µé¢ç»“æ„**:

```
/manuscripts
â”œâ”€â”€ page.tsx                  # æ–‡ç¨¿åˆ—è¡¨é¡µ
â”œâ”€â”€ [id]/
â”‚   â”œâ”€â”€ page.tsx             # æ–‡ç¨¿è¯¦æƒ…é¡µ(å±•ç¤ºå·ç« ç»“æ„ + ç»Ÿè®¡)
â”‚   â”œâ”€â”€ edit/
â”‚   â”‚   â””â”€â”€ page.tsx         # ç« èŠ‚ç¼–è¾‘å™¨(å·¦ä¾§å¤§çº²æ ‘,å³ä¾§ç¼–è¾‘å™¨)
â”‚   â””â”€â”€ settings/
â”‚       â””â”€â”€ page.tsx         # æ–‡ç¨¿è®¾ç½®(å…³è”å¤§çº²ã€è®¾å®šç­‰)
â”œâ”€â”€ components/
â”‚   â”œâ”€â”€ ManuscriptCard.tsx   # æ–‡ç¨¿å¡ç‰‡
â”‚   â”œâ”€â”€ ChapterTree.tsx      # ç« èŠ‚æ ‘
â”‚   â”œâ”€â”€ Editor.tsx           # Markdown ç¼–è¾‘å™¨
â”‚   â”œâ”€â”€ AIAssistPanel.tsx    # AI è¾…åŠ©é¢æ¿
â”‚   â””â”€â”€ StatsPanel.tsx       # ç»Ÿè®¡é¢æ¿
â””â”€â”€ api/
    â””â”€â”€ manuscripts.api.ts   # API å°è£…
```

**ä¸å…¶ä»–æ¨¡å—çš„åä½œå…³ç³»**:

- **ä¸å¤§çº²æ¨¡å—**: ä»å¤§çº²åˆ›å»ºæ–‡ç¨¿(è‡ªåŠ¨å¤åˆ¶å·ç« ç»“æ„)ã€åŒæ­¥æ›´æ–°ã€åå‘å…³è”
- **ä¸è®¾å®šé›†**: è®¾å®šæ³¨å…¥ã€@ å¼•ç”¨ã€è®¾å®šæé†’
- **ä¸å·¥ä½œå°**: æ˜¾ç¤ºæœ€è¿‘ç¼–è¾‘çš„æ–‡ç¨¿ç« èŠ‚ã€ä»Šæ—¥å­—æ•°ç»Ÿè®¡ã€å¿«é€Ÿç»§ç»­å†™ä½œå…¥å£

**å¼€å‘ä¼˜å…ˆçº§**:

- **Phase 1 - åŸºç¡€åŠŸèƒ½** (MVP): æ–‡ç¨¿é¡¹ç›®ç®¡ç†ã€å·ç« ç»“æ„ç®¡ç†ã€Markdown ç¼–è¾‘å™¨ã€è‡ªåŠ¨ä¿å­˜å’Œå­—æ•°ç»Ÿè®¡
- **Phase 2 - AI å¢å¼º**: AI ç»­å†™åŠŸèƒ½ã€è®¾å®šä¸Šä¸‹æ–‡æ³¨å…¥ã€AI æ¶¦è‰²/æ‰©å†™
- **Phase 3 - é«˜çº§åŠŸèƒ½**: @ å¼•ç”¨ç³»ç»Ÿé›†æˆã€å¯¼å‡ºåŠŸèƒ½ã€ç‰ˆæœ¬å†å²ã€ç»Ÿè®¡åˆ†æé¢æ¿

---

## 4. å®æ–½ç­–ç•¥ä¸è¿›åº¦

å»ºè®®é‡‡ç”¨åˆ†é˜¶æ®µã€è¿­ä»£çš„æ–¹å¼è¿›è¡Œå¼€å‘ï¼š

### 4.1. ç¬¬ä¸€é˜¶æ®µ (åŸºç¡€å»ºè®¾) - éƒ¨åˆ†å®Œæˆ âœ…

**å·²å®Œæˆ**:

- âœ… æ­å»º `è®¾å®šé›†` æ¨¡å—çš„åŸºç¡€é¡µé¢å’Œè·¯ç”±ç»“æ„
  - è®¾å®šé›†é¦–é¡µ (`/settings`)ï¼šé¡¹ç›®åˆ—è¡¨å±•ç¤ºï¼Œæ”¯æŒæœç´¢ã€ç­›é€‰ã€æ’åº
  - é¡¹ç›®å¡ç‰‡æ“ä½œï¼šæ”¯æŒé¡¹ç›®çš„ç¼–è¾‘å’Œåˆ é™¤åŠŸèƒ½ï¼Œä½¿ç”¨ç¡®è®¤å¼¹çª—é˜²æ­¢è¯¯åˆ 
  - é¡¹ç›®åˆ†ç±»é¡µ (`/settings/[projectId]`)ï¼šå±•ç¤ºé¡¹ç›®çš„å››å¤§è®¾å®šåˆ†ç±»
  - è®¾å®šåº“é¡µ (`/settings/library`)ï¼šç‹¬ç«‹è®¾å®šç®¡ç†å…¥å£
  - è®¾å®šåº“åˆ†ç±»åˆ—è¡¨é¡µ (`/settings/library/[category]`)ï¼šæ”¯æŒæœç´¢ã€æ ‡ç­¾ç­›é€‰ã€æ’åºï¼Œæ”¯æŒåˆ—è¡¨/å¡ç‰‡è§†å›¾åˆ‡æ¢
- âœ… å®ç° `è®¾å®šé›†` çš„å®Œæ•´åç«¯ API
  - Settings æ¨¡å—ï¼šè§’è‰²ã€ç³»ç»Ÿã€ä¸–ç•Œã€è¾…åŠ©è®¾å®šçš„å®Œæ•´ CRUD
  - Projects æ¨¡å—ï¼šé¡¹ç›®ç®¡ç†å’Œè®¾å®šå…³è”åŠŸèƒ½ï¼ŒåŒ…æ‹¬åˆ›å»ºã€æ›´æ–°ã€åˆ é™¤å’ŒæŸ¥è¯¢
  - å…³è”æ£€æŸ¥ï¼šåˆ é™¤è®¾å®šæ—¶è‡ªåŠ¨æ£€æŸ¥é¡¹ç›®å…³è”
- âœ… å®ç°å‰ç«¯æ•°æ®å¯¹æ¥
  - API å±‚ï¼šå®Œæ•´çš„æ¥å£å°è£…ï¼ˆ`settings.api.ts`ã€`projects.api.ts`ï¼‰
  - é¡µé¢å¯¹æ¥ï¼šè®¾å®šé›†é¦–é¡µå’Œè®¾å®šåº“é¡µé¢å·²å¯¹æ¥çœŸå®æ•°æ®
  - æ•°æ®å›æ˜¾ï¼šé¡¹ç›®ç¼–è¾‘æ—¶å®Œæ•´å›æ˜¾æ‰€æœ‰å­—æ®µæ•°æ®ï¼ˆåŒ…æ‹¬å…³è”çš„è®¾å®šï¼‰
- âœ… å®ç° `è®¾å®šé›†` æ¨¡å—çš„è®¾å®šåˆ›å»ºå’Œç¼–è¾‘åŠŸèƒ½ï¼ˆè§’è‰²ã€ç³»ç»Ÿã€ä¸–ç•Œã€è¾…åŠ©å››å¤§ç±»ï¼‰
- âœ… å®ç°é¡¹ç›®ç®¡ç†çš„å®Œæ•´åŠŸèƒ½ï¼ˆCRUDã€å…³è”è®¾å®šã€è¯¦æƒ…å¼¹çª—ã€äºŒæ¬¡ç¡®è®¤åˆ é™¤ï¼‰
- âœ… å®Œå–„å­—å…¸ç®¡ç†ç³»ç»Ÿï¼ˆæ•°æ®è§„èŒƒåŒ–ã€æ–°å¢æ—¶ä»£å’Œæ ‡ç­¾åˆ†ç±»ã€åŠ¨æ€åŒ–ç­›é€‰é€‰é¡¹ï¼‰
- âœ… å®ç° `å¤§çº²` æ¨¡å—çš„è®¾å®šå…³è”åŠŸèƒ½ï¼ˆæ”¯æŒæ·»åŠ /ç§»é™¤è®¾å®šã€AI ç”Ÿæˆæ—¶è‡ªåŠ¨æ³¨å…¥ä¸Šä¸‹æ–‡ï¼‰
- âœ… å®ç° `å¤§çº²` æ¨¡å—çš„ç»“æ„åŒ–ç¼–è¾‘åŠŸèƒ½ï¼ˆåˆ›å»º/åˆ é™¤å·ç« ã€è‡ªåŠ¨æ’åºã€æ•æ„Ÿè¯æ£€æŸ¥ã€çº§è”åˆ é™¤ï¼‰

- âœ… å®ç° `æ–‡ç¨¿` æ¨¡å—ï¼ˆPhase 1 åŸºç¡€åŠŸèƒ½ + Phase 2 AI å¢å¼º + é«˜ä¼˜å…ˆçº§åŠŸèƒ½ï¼‰
  - åç«¯ï¼šå®Œæ•´çš„ CRUD APIã€ä»å¤§çº²åˆ›å»ºã€å·ç« ç®¡ç†ã€å†…å®¹ä¿å­˜ã€ç‰ˆæœ¬å†å²ã€ç« èŠ‚å‘å¸ƒã€å­—æ•°ç»Ÿè®¡ã€è®¾å®šå…³è”ã€æ’åºæ¥å£
  - å‰ç«¯ï¼šæ–‡ç¨¿åˆ—è¡¨/è¯¦æƒ…é¡µã€åˆ›å»º/ç¼–è¾‘å¯¹è¯æ¡†ã€å·ç« æ ‘ã€ç¼–è¾‘å™¨ã€è‡ªåŠ¨ä¿å­˜ã€ä¾§è¾¹æ ã€æœ€åç¼–è¾‘ä½ç½®è·³è½¬ã€æ‹–æ‹½æ’åº UI
  - AI åŠŸèƒ½ï¼šç»­å†™/æ¶¦è‰²/æ‰©å†™æ¥å£åŠ UIã€è®¾å®šä¸Šä¸‹æ–‡æ³¨å…¥ã€æ”¯æŒé€‰ä¸­æ–‡æœ¬è¿›è¡Œ AI æ“ä½œ

**å¾…å®Œæˆ**:

æ— 

### 4.2. ç¬¬äºŒé˜¶æ®µ (MVP å®Œå–„) - ğŸ”¥ è¿›è¡Œä¸­

**æ ¸å¿ƒç›®æ ‡ï¼šå¿«é€Ÿæ‰“é€šæ•´ä¸ªåˆ›ä½œæµç¨‹ï¼Œè®©ç”¨æˆ·èƒ½å®Œæ•´ä½“éªŒä»è®¾å®šåˆ°æˆç¨¿çš„å…¨é“¾è·¯**

#### å·²å®Œæˆï¼š

1. âœ… **@ æ™ºèƒ½å¼•ç”¨ç³»ç»Ÿ MVP**ï¼ˆæ ¸å¿ƒä»·å€¼ï¼‰
   - åç«¯ï¼šç»Ÿä¸€æœç´¢æ¥å£ï¼ˆæœç´¢æ‰€æœ‰è®¾å®šï¼‰- å·²å®ç° SearchModule
   - ç¼–è¾‘å™¨æ’ä»¶ï¼šè¾“å…¥ @ è§¦å‘æœç´¢å’Œæ’å…¥ - å·²å®ç° EnhancedMdEditor
   - æ’å…¥é“¾æ¥æ ¼å¼ï¼š`[@è®¾å®šåç§°](moge://type/id)` - å·²æ”¯æŒ
   - å½±å“ï¼šæˆåŠŸè¿é€šè®¾å®šé›†ã€å¤§çº²ã€æ–‡ç¨¿ä¸‰å¤§æ¨¡å—

#### å¾…å®Œæˆï¼ˆå½±å“ä¸»æµç¨‹ï¼‰ï¼š

2. **å·¥ä½œå°æœ€å°åŠŸèƒ½é›†**ï¼ˆç”¨æˆ·å…¥å£ï¼‰
   - å¿«é€Ÿè®¿é—®ï¼šæœ€è¿‘çš„ 3 ä¸ªé¡¹ç›®/å¤§çº²/æ–‡ç¨¿
   - ä»Šæ—¥ç»Ÿè®¡ï¼šä»Šæ—¥å­—æ•°ã€æœ¬å‘¨å­—æ•°
   - å¿«é€Ÿåˆ›å»ºï¼šä¸€é”®åˆ›å»ºé¡¹ç›®/å¤§çº²/æ–‡ç¨¿
   - å½±å“ï¼šç”¨æˆ·çš„ä¸»è¦å·¥ä½œå…¥å£ï¼Œæå‡æ•ˆç‡

3. **å¯¼å‡ºåŠŸèƒ½**ï¼ˆä»·å€¼é—­ç¯ï¼‰
   - TXT å¯¼å‡ºï¼ˆæœ€åŸºç¡€ï¼‰
   - æ‰¹é‡å¯¼å‡ºç« èŠ‚
   - å½±å“ï¼šè®©ç”¨æˆ·çš„åˆ›ä½œæˆæœèƒ½å¤Ÿè¾“å‡ºä½¿ç”¨

### 4.3. ç¬¬ä¸‰é˜¶æ®µ (ä½“éªŒä¼˜åŒ–) - å¯å»¶å

ä»¥ä¸‹åŠŸèƒ½ä¸å½±å“ä¸»æµç¨‹ï¼Œå¯åœ¨ MVP åé€æ­¥å®Œå–„ï¼š

- **@ ç³»ç»Ÿé«˜çº§åŠŸèƒ½**ï¼šæ‚¬æµ®é¢„è§ˆå¡ç‰‡ã€åå‘é“¾æ¥æ˜¾ç¤ºã€Markdown è‡ªå®šä¹‰æ¸²æŸ“
- **AI åŠŸèƒ½å¢å¼º**ï¼šæ™ºèƒ½è¯†åˆ«ç›¸å…³è®¾å®šã€ä¼˜å…ˆä½¿ç”¨é«˜ç›¸å…³åº¦è®¾å®š
- **ç»Ÿè®¡åˆ†æ**ï¼šå­—æ•°è¶‹åŠ¿å›¾ã€å†™ä½œä¹ æƒ¯åˆ†æã€é¡¹ç›®è´¡çŒ®åº¦ã€è®¾å®šä½¿ç”¨ç»Ÿè®¡
- **ç‰ˆæœ¬ç®¡ç†**ï¼šå†å²ç‰ˆæœ¬æŸ¥çœ‹å’Œå›æ»šï¼ˆåç«¯å·²æ”¯æŒï¼‰
- **é«˜çº§å¯¼å‡º**ï¼šEPUB/DOCX æ ¼å¼ã€è‡ªå®šä¹‰æ ·å¼
- **å·¥ä½œå°æ‰©å±•**ï¼šçµæ„Ÿä¾¿ç­¾ã€åˆ›ä½œç›®æ ‡ã€å¾…åŠæ¸…å•
- **æ–‡ç¨¿å¢å¼º**ï¼šå°é¢ç®¡ç†ã€è¿›åº¦é‡Œç¨‹ç¢‘ã€å…³è”è®¾å®šè¯¦æƒ…å¡ç‰‡
- **æ€§èƒ½ä¼˜åŒ–**ï¼šå¤§æ–‡ä»¶å¤„ç†ã€å®æ—¶åä½œã€ç¦»çº¿æ”¯æŒ

---

## 5. å¼€å‘å»ºè®®

### 5.1. å¿«é€Ÿæ‰“é€šæµç¨‹çš„å®æ–½æ­¥éª¤

**ç›®æ ‡ï¼šç”¨ 1-2 å‘¨æ—¶é—´å®Œæˆ MVPï¼Œè®©ç”¨æˆ·èƒ½ä½“éªŒå®Œæ•´æµç¨‹**

#### å·²å®Œæˆè¿›å±•ï¼š

âœ… **Day 1-2**: @ å¼•ç”¨ç³»ç»Ÿåç«¯

- åˆ›å»ºäº†ç»Ÿä¸€æœç´¢ APIï¼ˆæ•´åˆè§’è‰²ã€ç³»ç»Ÿã€ä¸–ç•Œã€è¾…åŠ©è®¾å®šï¼‰
- å®ç°äº† SearchModule å’Œ SearchService
- è¿”å›æ ¼å¼ï¼š`{ id, type, name, description, projectId }`

âœ… **Day 3-4**: @ å¼•ç”¨ç³»ç»Ÿå‰ç«¯

- ç¼–è¾‘å™¨æ’ä»¶å¼€å‘ï¼ˆç›‘å¬ @ è¾“å…¥ï¼Œå¼¹å‡ºæœç´¢æ¡†ï¼‰
- å®ç°äº† AtMentionSearch ç»„ä»¶å’Œ EnhancedMdEditor
- æ’å…¥é“¾æ¥æ ¼å¼ï¼š`[@è®¾å®šåç§°](moge://type/id)`

#### å‰©ä½™ä»»åŠ¡ï¼š

**Day 5-6**: å·¥ä½œå°åŸºç¡€åŠŸèƒ½

- æœ€è¿‘è®¿é—®åˆ—è¡¨ï¼ˆè°ƒç”¨ç°æœ‰ APIï¼‰
- ä»Šæ—¥/æœ¬å‘¨å­—æ•°ç»Ÿè®¡å¡ç‰‡
- å¿«é€Ÿåˆ›å»ºæŒ‰é’®ç»„

**Day 7**: å¯¼å‡ºåŠŸèƒ½

- TXT æ ¼å¼å¯¼å‡ºï¼ˆå•ç« èŠ‚/æ‰¹é‡ï¼‰
- ä¿ç•™ Markdown åŸºç¡€æ ¼å¼

**Day 8-9**: é›†æˆæµ‹è¯•

- å®Œæ•´æµç¨‹æµ‹è¯•ï¼šåˆ›å»ºé¡¹ç›® â†’ è®¾å®š â†’ å¤§çº² â†’ æ–‡ç¨¿ â†’ å¯¼å‡º
- ä¿®å¤å…³é”® Bug

**Day 10**: æ€§èƒ½ä¼˜åŒ–

- ä¼˜åŒ–æœç´¢æ€§èƒ½ï¼ˆæ·»åŠ ç´¢å¼•ã€ç¼“å­˜ï¼‰
- ä¼˜åŒ–ç¼–è¾‘å™¨å“åº”é€Ÿåº¦

### 5.2. æŠ€æœ¯å®ç°è¦ç‚¹

#### @ å¼•ç”¨ç³»ç»Ÿå®ç°å»ºè®®

```typescript
// åç«¯æœç´¢æ¥å£
GET /api/search/settings?q=å…³é”®è¯&projectId=123

// å‰ç«¯ç¼–è¾‘å™¨æ’ä»¶æ ¸å¿ƒä»£ç ç»“æ„
const AtMentionPlugin = {
  onKeyDown: (event) => {
    if (event.key === '@') {
      showSearchPopup();
    }
  },
  onSelect: (item) => {
    insertLink(`[@${item.name}](moge://${item.type}/${item.id})`);
  }
};
```

#### å·¥ä½œå°æ•°æ®èšåˆ

```typescript
// ä½¿ç”¨å¹¶è¡Œè¯·æ±‚æé«˜æ€§èƒ½
const [projects, outlines, manuscripts] = await Promise.all([
  getRecentProjects(3),
  getRecentOutlines(3),
  getRecentManuscripts(3),
]);
```

### 5.3. æ³¨æ„äº‹é¡¹

1. **ä¿æŒç®€å•**ï¼šMVP é˜¶æ®µä¸è¿½æ±‚å®Œç¾ï¼Œå…ˆå®ç°åŸºç¡€åŠŸèƒ½
2. **å¤ç”¨ç°æœ‰ä»£ç **ï¼šæœ€å¤§åŒ–åˆ©ç”¨å·²æœ‰ç»„ä»¶å’Œ API
3. **æ¸è¿›å¢å¼º**ï¼šå…ˆå®ç°æ–‡æœ¬é“¾æ¥ï¼Œåç»­å†æ·»åŠ é¢„è§ˆå¡ç‰‡
4. **ç”¨æˆ·åé¦ˆ**ï¼šå°½å¿«è®©ç”¨æˆ·è¯•ç”¨ï¼Œæ”¶é›†åé¦ˆåè¿­ä»£
