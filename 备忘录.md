# 墨阁 (Moge) 功能规划备忘录

本文档旨在沉淀和梳理“墨阁”应用未来的功能规划与设计思路，作为后续开发的统一参考。

---

## 第一部分：核心功能现状

应用目前已具备稳定可靠的核心功能：

1.  **用户系统**:
    - 支持账号密码注册与登录。
    - 支持 GitLab 第三方授权登录。
    - 提供个人中心，可修改个人资料与密码。

2.  **大纲管理**:
    - 支持大纲的创建、编辑、删除和列表展示。
    - 支持多维度筛选（名称、类型、时代、标签等）与排序。
    - 具备核心的 **AI 流式生成** 大纲内容的能力。
    - 提供基于 Markdown 的结构化内容查看与编辑功能。

3.  **基础体验**:
    - 支持明/暗两种主题模式。
    - 支持中/英双语切换。

---

## 第二部分：新版菜单结构

为支撑未来的功能扩展，我们已确定并实施了新的侧边栏菜单结构：

- **`工作台` (Workspace)**: `href: /workspace`
  - **定位**: 应用的仪表盘和启动页，提供信息概览和快捷入口。
- **`大纲` (Outlines)**: `href: /outline`
  - **定位**: 核心的灵感构思与故事结构设计中心。
- **`文稿` (Manuscripts)**: `href: /manuscripts`
  - **定位**: 基于大纲进行具体章节内容创作的管理中心。
- **`世界观` (World-building)**: `href: /worldview`
  - **定位**: 创作所需的一切背景设定的“专属维基百科”。
- **`统计` (Analytics)**: `href: /stats`
  - **定位**: 对创作过程进行数据化复盘与分析的工具。

---

## 第三部分：未来功能详细规划

### 1. `工作台` (/workspace) 模块

- **欢迎与快速入口**: 显示个性化问候，并提供“新建大纲”、“新建文稿”等核心操作的快捷按钮。
- **最近项目**: 以列表形式展示最近编辑过的文档（大纲、章节、设定），方便快速投入工作。
- **统计概览**: 以卡片和微图表形式，展示“今日字数”、“本周动态”等关键数据，作为“统计”页面的精简版。
- **创作目标/待办清单**: 提供一个简易的 To-Do List，帮助作者管理每日写作计划。
- **灵感便签**: 一个用于随手记录零散想法的区域。

### 2. `文稿` (/manuscripts) 模块

- **文稿列表**: 集中展示所有“小说项目”。
- **状态管理**: 支持按“进行中”、“已完结”、“构思中”等状态对小说项目进行筛选和管理。
- **章节组织**: 在每个文稿内部，提供创建、排序和管理章节的能力。

### 3. `世界观` (/worldview) 模块

- **模板化创建**: 为“角色”、“地点”、“物品”等不同设定提供结构化的模板，引导用户填写关键信息。
- **视图切换**:
  - **网格视图**: 以卡片形式展示设定，突出图片和简介。
- **子路由结构**: 采用 `worldview/characters/[id]` 这样的清晰层级，分离“主页”、“列表页”和“详情页”。

### 4. `统计` (/stats) 模块

- **深度分析**: 提供独立、强大的数据分析功能。
- **功能**: 支持按时间范围（本周、本月、本年）查看详细的字数趋势图、项目贡献度分析、写作活跃时间分布等。

---

## 第四部分：全局核心系统规划

### `@` 智能引用系统

这是打通所有模块、提升产品价值的核心系统。

- **目标**: 实现 `世界观`、`大纲`、`正文` 之间的无缝链接。
- **核心流程**:
  1.  **触发与插入**: 在任何编辑器中输入 `@`，触发全局设定搜索，选择后插入一个包含唯一ID的稳定链接（如 `[@风雪城](moge://item/uuid-xxx)`）。
  2.  **悬浮与跳转**: 在阅读时，鼠标悬浮于 `@链接` 上可预览设定简介卡片；点击则直接跳转至该设定的详情页。
  3.  **反向链接**: 在设定的详情页，能自动展示所有引用了该设定的“出场章节”列表。
- **技术要点**: 需要后端提供统一搜索接口、前端实现编辑器插件和 Markdown 自定义渲染组件。

---

## 第五部分：实施策略建议

建议采用分阶段、迭代的方式进行开发：

1.  **第一阶段 (基础建设)**:
    - 搭建 `文稿` 和 `世界观` 模块的基础页面和路由结构。
    - 优先实现 `世界观` 模块的模板化创建和列表/表格视图功能。
    - 实现 `文稿` 模块的列表及状态管理。

2.  **第二阶段 (核心价值)**:
    - 实现 `@` 智能引用系统的 MVP 版本（完成搜索、插入和点击跳转）。
    - 实现 `工作台` 的“最近项目”和“统计概览”模块。

3.  **第三阶段 (体验增强)**:
    - 为 `@` 系统增加悬浮预览卡片和反向链接功能。
    - 完善独立的 `统计` 页面，提供深度数据分析。
    - 完成 `工作台` 的其余模块。
